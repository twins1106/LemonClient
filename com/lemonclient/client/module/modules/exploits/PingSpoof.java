//Deobfuscated with https://github.com/SimplyProgrammer/Minecraft-Deobfuscator3000 using mappings "C:\Users\user\πŸ≈¡ »≠∏È\map"!

//Decompiled by Procyon!

package com.lemonclient.client.module.modules.exploits;

import com.lemonclient.client.module.*;
import com.lemonclient.api.setting.values.*;
import com.lemonclient.api.util.misc.*;
import net.minecraft.network.play.client.*;
import com.lemonclient.api.event.events.*;
import me.zero.alpine.listener.*;
import java.util.function.*;
import net.minecraft.network.*;

@Module.Declaration(name = "PingSpoof", category = Category.Exploits)
public class PingSpoof extends Module
{
    IntegerSetting ping;
    Timer timer;
    CPacketKeepAlive cPacketKeepAlive;
    @EventHandler
    private final Listener<PacketEvent.Send> sendListener;
    
    public PingSpoof() {
        this.ping = this.registerInteger("Ping", 100, 1, 10000);
        this.timer = new Timer();
        this.cPacketKeepAlive = null;
        this.sendListener = (Listener<PacketEvent.Send>)new Listener(event -> {
            if (event.getPacket() instanceof CPacketKeepAlive && this.cPacketKeepAlive != event.getPacket() && (int)this.ping.getValue() != 0) {
                this.cPacketKeepAlive = (CPacketKeepAlive)event.getPacket();
                event.cancel();
                this.timer.reset();
            }
        }, new Predicate[0]);
    }
    
    public void onUpdate() {
        if (this.timer.hasReached((long)this.ping.getValue()) && this.cPacketKeepAlive != null) {
            PingSpoof.mc.player.connection.sendPacket((Packet)this.cPacketKeepAlive);
            this.cPacketKeepAlive = null;
        }
    }
}
